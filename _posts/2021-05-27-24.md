---
layout: post
title: Dandi.(단디) 개발 후기 (2)
toc: true
tags: [iOS, Swift, Xcode, Project, Dandi]
categories: Project
---

지난 후기에 이어서 이번 포스팅에서는 런칭 이후 발생한 주요 이슈와 단디에 관해 남은 숙제에 대해 다루어보려고 한다.


## 주요 이슈 - 런칭 이후

런칭 이후에도 문제가 발생했는데, 이 역시 위젯과 관련된 문제였다. 애플리케이션 내에 저장한 디데이 엔트리 수가 일정 갯수를 넘어가면 위젯 작동이 비정상 종료되어버리는 현상이었다.

<div style="text-align:center;">
  <img src="{{ site.baseurl }}/images/dandi_images/issue22.jpeg" width="40%">
  <img src="{{ site.baseurl }}/images/dandi_images/issue11.jpeg" width="40%">
</div>
<br>

위젯 편집을 하거나, 편집을 하지 않더라도 처음부터 검은 화면만 나와버리는 문제였다. 시뮬레이터에서 위젯 익스텐션을 빌드한 후 애플리케이션에서 디데이 엔트리 갯수를 하나씩 늘리다가 7개 이상이 되자 메모리 이슈 때문에 비정상 종료되었다는 경고 문구가 나타났다.

<div style="text-align:center;">
  <img src="{{ site.baseurl }}/images/dandi_images/memory_issue.png" width="50%">
</div>

<br>
이미 런칭 이전에 이미지 사이즈로 인한 이슈를 겪었던 경험 덕분(?)에 메모리 이슈 역시 이미지 용량이 원인이라는 추측이 가능했다. 위젯과 관련된 메모리 이슈에 대해 구글링하고 난 후 추측은 확신으로 바뀌었다.

[WidgetKit Memory Leak on Images](https://developer.apple.com/forums/thread/650204)

위젯의 경우 지정해둔 타임라인 간격에 따라 표시할 스냅샷을 미리 배열로 저장해두고 정해진 시간이 되면 해당 스냅샷을 내보는 방식으로 동작하기 때문에 스냅샷 내의 큰 이미지 용량이 메모리에 영향을 준 게 아닐까...하고 막연히 생각 중이다.

해결책은 url기반의 이미지를 사용하거나 이미지 용량을 줄여야하는 것인데 서버리스 앱이기 때문에 url을 가져와 사용하기엔 어려움이 있다고 판단, 디데이 엔트리에 저장되는 이미지 용량을 줄이기로 결정했다.

압축 및 리사이징으로 용량을 줄였고, 부득이하게 생성 가능한 디데이 갯수를 30개로 제한한 후 빌드했더니 문제 없이 동작하는 것을 확인할 수 있었다.

<div style="text-align:center;">
  <img src="{{ site.baseurl }}/images/dandi_images/issue_test.png" width="40%">
  <img src="{{ site.baseurl }}/images/dandi_images/issue_test2.png" width="40%">
</div>
<br>


## 약 2주간의 운영과 남은 숙제

사실 2주간의 운영 후기는 위에서 작성한 런칭 이후 이슈 관련이 대부분이었다. 그 외에 기능에 대한 피드백이 있었다면 아래와 같은 내용이 있었다고 할 수 있겠다.

- ~~디데이 수정 후 정보가 위젯에 바로 반영되지 않는다.~~ (1.03버전에서 해결했다.)
- ~~디데이 제목이 길 때 디데이 상세 화면에서 잘려 보여서 불편하다.~~ (1.03 버전에서 해결했다.)
- 여러 디데이 정보를 한번에 추가할 수 있는 기능이 있었으면 좋겠다.
- 디데이 알림 설정 시 소리가 나지 않아 자칫 모르고 지나칠 수 있어 불편하다.
- 디데이 제목에 특정 단어(시험, 과제 등)가 포함되어 있다면, 재촉 알림이 있었으면 좋겠다.
- ~~사진을 찍어서 바로 배경 이미지로 사용할 수 있으면 좋겠다.~~ (1.04버전에서 수정 예정: Updated 2021.06.07)
- ~~디데이 날짜 선택 시 요일 확인이 가능하도록 달력 형태의 선택창이 나타나면 좋을 것 같다.~~ (1.04버전에서 수정 예정: Updated 2021.06.07)


그 외에 내가 추후 개선하고 싶은 점은 다음과 같다.

- 위젯 세부 설정(제목, 디데이 글자 크기 조절 등)
- 배경 이미지 편집
- 애플리케이션에 추가할 수 있는 디데이 갯수 증가
- 디데이 정보 백업 또는 iCloud 동기화


아직 운영 극초기 단계이기 때문에 할 수 있는 선 안에서 차근차근 수정하고 개선하고자 한다.<br>
비록 간단한 서비스지만 유저와 소통하며 오랫동안 운영할 수 있는 애플리케이션이 되었으면 좋겠다.
